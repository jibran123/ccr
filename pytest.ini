[pytest]
# Pytest Configuration for Common Configuration Repository (CCR)
# Week 13-14: Testing & Quality Assurance

# Test discovery patterns
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Console output options
console_output_style = progress
addopts =
    # Verbose output
    -v
    # Short traceback format
    --tb=short
    # Show local variables in tracebacks
    --showlocals
    # Show summary of all test outcomes
    -ra
    # Enable strict markers (fail on unknown markers)
    --strict-markers
    # Disable warnings in output (but still capture them)
    --disable-warnings
    -p no:warnings

# Custom markers for test categorization
markers =
    # Test type markers
    unit: Unit tests (fast, no external dependencies)
    integration: Integration tests (require app context and database)
    security: Security-related tests (authentication, authorization, etc.)
    performance: Performance and optimization tests (caching, compression)
    load: Load and stress tests (slow, high resource usage)

    # Special markers
    slow: Tests that take significant time to run (>5 seconds)
    skip_ci: Skip in CI/CD pipeline (manual testing only)
    requires_auth: Tests that require valid authentication tokens
    requires_db: Tests that require MongoDB connection
    production: Production-only tests (manual verification required)

    # Feature markers
    auth: Authentication related tests
    backup: Backup/restore related tests
    rate_limit: Rate limiting tests
    token: Token management tests
    brute_force: Brute force protection tests
    headers: Security headers tests
    caching: Cache performance tests
    compression: Response compression tests

# Minimum Python version
minversion = 3.8

# Log settings (for debugging)
log_cli = false
log_cli_level = INFO
log_file_level = DEBUG

# Timeout for individual tests (requires pytest-timeout plugin)
# Uncomment when pytest-timeout is installed
# timeout = 300

# Parallel execution (requires pytest-xdist plugin)
# Uncomment to enable parallel test execution
# -n auto  # Run tests in parallel using all available cores
